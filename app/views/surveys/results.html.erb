<h2>
	Cumulative Survey Results for: <br />
	<i><%= @survey.survey_name %></i>
</h2>

<p>
	At the top of this page you will find statistics for the multiple choice
	questions on the survey.  Past this information, towards the bottom, you
	can view the individual answers for each person the survey was administered
	to.
</p>
<hr>
<% @counter = 0 %>
<% @survey.mcquestions.each do |t|%>

<h1>Multiple Choice Question Statistics</h1>
	<hr>
	<h3>Question Number: <%=  @counter += 1%></h3>
	<h4>Question Text:</h4> 
	<%= t.question_text%>
	<h4>Question Answer(s):</h4>
	
	<% if Mcanswer.exists?(:mcquestion_id => t)%>
		<% @showanswer = Mcanswer.find(:last, :conditions => {:mcquestion_id => t.id})%>
		<% if @showanswer.theanswer_1%>
			<p>
			  <%=h t.answer_1 %>
			</p>
		<% end %>
			
		<% if @showanswer.theanswer_2%>
			<p>
			  <%=h t.answer_2 %>
			</p>
		<% end %>
			
		<% if @showanswer.theanswer_3%>
			<p>
			  <%=h t.answer_3 %>
			</p>
		<% end %>
			
		<% if @showanswer.theanswer_4%>
			<p>
			  <%=h t.answer_4 %>
			</p>
		<% end %>
			
		<% if @showanswer.theanswer_5%>
			<p>
			  <%=h t.answer_5 %>
			</p>
		<% end %>
	<% else %>
		<h3>The user has not answered this question yet.</h3>
	<% end %>
	<hr>
<% end %>

<h1>Individual Results</h1>
<hr>
<table>
	<tr>
	    <th>Survey Taker</th>
		<th>Survey Status*</th>
	    <th>View Individual Results</th>
	</tr>
	<% @survey.usersurveys.each do |t| %>
	<tr>
  		<td><%= User.find(t.user_id.to_int).name %></td>
		<td>
			<% if t.taken %>
				Completed
			<% else %>
				Incomplete
			<% end %>
		</td>
		<td><%= button_to "View", "/usersurveys/results/" + t.id.to_s %></td>
  	</tr>
	
<% end %>
</table>
<p>
	*Complete means the survey has been filled out and submitted by the user.
	Incomplete means the survey has not yet been filled out by the user.
</p>
<p>
	
</p>

<p>
	<%= link_to 'Back', surveys_path %>
</p>
